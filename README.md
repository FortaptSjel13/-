# Проектирование витрины данных
## Ссылка на исходный датасет: https://www.kaggle.com/datasets/ealaxi/paysim1/data
**Содержание исходного датасета:** "PaySim имитирует мобильные финансовые транзакции на основе выборки реальных транзакций, извлеченных из финансовых журналов за один месяц работы сервиса мобильных платежей, работающего в одной из африканских стран. Оригинальные журналы были предоставлены международной компанией, являющейся поставщиком мобильного финансового сервиса, который в настоящее время доступен более чем в 14 странах мира".

## Цели проекта:
- Провести исследование исходного датасета, проверить на наличие аномалий.
- Построить ER-диаграмму и привести данные к 3НФ.
- Построить таблицы фактов и измерений через pandas.
- Создать БД и витрину данных в Postgres для анализа транзакций и отслеживания фродовой активности.
- Написать SQL скрипты для проверки корректности витрины.

## Содержание исходного датасета:
**Исходный датасет содержит более 6 млн строк с информацией о:**
- отправителях и получателях
- типах операций (TRANSFER, CASH_IN, PAYMENT, CASH_OUT, DEBIT)
- балансах отправителей и получателей до и после операции
- признаках мошенничества (is_fraud, is_flagged_fraud)

## 1. Подготовка исходного датасета 
- Проверены пропуски и дубликаты (не обнаружены)
- Исключены отрицательные суммы
- Выявлены аномалии:
    - Баланс отправителя после транзакции становится больше и равняется сумме транзакции. Принято решение оставить эти записи как особенность симуляции
    - В 1.2 млн строк баланс получателя после TRANSFER и CASH_IN стал меньше. Строки также сохранены для корректного анализа
    - Выявлено 1769 клиентов, которые бывают как отправителями, так и получателями

## 2. Построение ER-диаграммы и прриведение данных к 3НФ
- Выделены три таблицы измерений (clients, dates, transaction_types)
- Построена ER-диаграмма в виде звездной схемы
- Все колонки атомарны, нет множественных значений (1НФ)
- Все неключевые атрибуты (amount, old_balanse_orig, new_balance_orig, old_balance_dest, new_balanse_dest, is_fraud, is+flagged_fraud) зависят от всего первичного ключа (transaction_id), (нет частичной зависимости) (2НФ)
- Нет транзитивной зависимости между неключевыми атрибутами (3НФ)
## 3. Построение таблиц фактов и измерений
**На основе исходного датасета в pandas были подготовлены:**
  - Фактовая таблица **fact_transactions**, содержащая информацию о всех транзакциях с ключами на таблицы измерений
  - Измерения:
      - **clients** - справочник клиентов
      - **transaction_types** - справочник типов транзакций
      - **dates** - календарь по шагам (часы, дни недели, недели месяца)
## Таблицы фактов и измерений для БД хранятся на гугл диске: https://drive.google.com/drive/folders/1poCZl6WkuAf5IeXfT65Sl0jwLghnzYqV?usp=sharing


 
